<div class="d-flex align-items-center flex-wrap justify-content-between mb-3">
    <div class="d-flex align-items-center justify-content-start">
        <h4 class="mr-3 mb-0"><a class="text-dark" (click)="navigateBack()">
            <i class="fa fa-arrow-left"></i></a></h4>
        <h1 class="page-title mb-0">Patient Health Score Form</h1>
      </div>
</div>
<div class="row">
    <div class="col-md-12">
        <div class="form-group d-flex align-items-center">
            <label for="searchBy" class="mb-0 mr-3">Title</label>
            <div class="flex-grow-1">
              <input type="text" [(ngModel)]="addEditPHSFormDto.title" autocomplete="off"
                class="form-control form-control-sm box-shadow w-100" id="searchBy" placeholder="Title" />
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="form-group d-flex align-items-center">
            <label style="min-width: 90px;" for="searchBy" class="mb-0 mr-3">Module</label>
            <div class="flex-grow-1">
                <ng-select [(ngModel)]="addEditPHSFormDto.moduleIds" class="ng-select-small" [multiple]="true" [searchable]="true"
                    placeholder="Module">
                    <ng-option [value]="item.value" *ngFor="let item of twoCModulesEnumList" >{{item.name}}</ng-option>
                </ng-select>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="form-group d-flex align-items-center">
            <label  style="min-width: 90px;" for="searchBy" class="mb-0 mr-3">Diagnosis</label>
            <div class="flex-grow-1">
                <ng-select [(ngModel)]="addEditPHSFormDto.chronicConditionIds" class="ng-select-small" [multiple]="true" [searchable]="true"
                placeholder="Select Diagnosis">
                <ng-option [value]="item.id" *ngFor="let item of cronicDiseaseList" >{{item.algorithm}}</ng-option>
            </ng-select>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="form-group d-flex align-items-center">
            <label  style="min-width: 90px;" for="searchBy" class="mb-0 mr-3">Care Episode</label>
            <div class="flex-grow-1">
              <ng-select class="ng-select-small" [(ngModel)]="addEditPHSFormDto.phsCareEpisodeIds" [multiple]="true" [searchable]="true"
                    placeholder="Episode">
                  <ng-option [value]="item.id" *ngFor="let item of phsCareEpisodesList" >{{item.name}}</ng-option>
                  <ng-option [value]="item.id" *ngFor="let item of phsCareEpisodesList" >{{item.name}}</ng-option>
              </ng-select>
            </div>
        </div>
    </div>
</div>
<p *ngFor="let question of addEditPHSFormDto.phsFormQuestions" >Description: {{question.description}}, Type: {{phsFormQuestionTypeEnum[question.questionType]}}  <span (click)="fillQuestionOptionType(question)"  style="color: green;cursor:pointer;">Edit</span></p>
<div class="search-filter collapseable" *ngIf="showAddQuestionTab">
    <div class="panel mt-3" style="overflow: visible;">
        <div class="panel-header py-2 d-flex justify-content-end align-items-center">
                <button (click)="resetValues()" type="button" aria-label="Close" class="close " (click)="showAddQuestionTab=false">
                    <span aria-hidden="true">Ã—</span>
                </button>
        </div>
        <div class="panel-body">
            <div class="row">
                <div class="col-md-8">
                    <div class="form-group ">
                        <div class="d-flex justify-content-between align-items-center">
                            <label for="searchBy" class="">Question</label>
                            <div class="custom-control custom-checkbox">
                                <input [(ngModel)]="addEditPHSFormQuestionDto.isMandatory" class="custom-control-input" type="checkbox" id="mandatory">
                                <label class="custom-control-label" for="mandatory">Mandatory</label>
                            </div>
                        </div>
                        <input type="text"  autocomplete="off"
                            class="form-control form-control-sm box-shadow w-100" [(ngModel)]="addEditPHSFormQuestionDto.description" id="searchBy" placeholder="Description" />
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="form-group">
                        <label for="searchBy" class="">Answer Type</label>
                        <ng-select class="ng-select-small" [multiple]="false" [(ngModel)]="addEditPHSFormQuestionDto.questionType" [searchable]="false"
                            placeholder="Answer Type">
                            <ng-option [value]="item.value" *ngFor="let item of phsFormQuestionTypeEnumList" value="yesno">{{item.name}}</ng-option>
                        </ng-select>
                    </div>
                </div>
                <div class="col-md-12">
                    <div class="form-group ">
                        <label for="searchBy" class="">Tooltip</label>
                        <input type="text" [(ngModel)]="addEditPHSFormQuestionDto.toolTip"  autocomplete="off" class="form-control form-control-sm box-shadow w-100"
                         id="searchBy" placeholder="Write Information" />
                    </div>
                    <button *ngIf="!addEditPHSFormQuestionDto.id" [disabled]="!addEditPHSFormQuestionDto.description" class="btn btn-dynamic-2c btn-sm mx-0 mt-0 mb-0" (click)="saveQuestion('add')">Save Question</button>
                    <button *ngIf="addEditPHSFormQuestionDto.id" [disabled]="!addEditPHSFormQuestionDto.description" class="btn btn-dynamic-2c btn-sm mx-0 mt-0 mb-0" (click)="saveQuestion('edit')">Edit Question</button>
                    <!-- <button  class="btn btn-dynamic-2c btn-sm mx-0" ><i class="fa fa-plus mr-1" ></i>Add new option</button> -->
                    <div>
                        <button [disabled]="addEditPHSFormQuestionDto.questionType == 0 && phsQuestionOptionsList.length >= 2" (click)="showAddAnswerTab=true" *ngIf="addEditPHSFormQuestionDto.id" class="addoption">
                            <span class="fa fa-plus mr-1"></span> Add Option
                        </button>
                    </div>
                </div>
                <div class="col-md-12">
                    <div *ngFor="let item of phsQuestionOptionsList" class="border-question">
                        <div (click)="openConfirmModal(item.id)" class="cross-option ">
                            <span class="fa fa-trash-o fa-lg text-grey"></span>
                        </div>
                        <div class="row">
                            <div class="col-md-7 ">
                                <div class="form-group mb-0">
                                    <label for="searchBy" class="">Answer Option</label>
                                    <input type="text" [(ngModel)]="item.text" autocomplete="off" class="form-control form-control-sm box-shadow w-100"
                                     id="searchBy" placeholder="Answer Option" value="Yes" />
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="form-group mb-0">
                                    <label for="searchBy" class="">Weight</label>
                                    <input type="number" [(ngModel)]="item.weight" autocomplete="off" class="form-control form-control-sm box-shadow w-100"
                                     id="searchBy" placeholder="Weight" />
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group mb-0">
                                    <label for="searchBy" class="">Flag</label>
                                    <ng-select class="ng-select-small" [(ngModel)]="item.flag" [multiple]="false"
                                        placeholder="Answer Type">
                                        <ng-option [value]="item.value" *ngFor="let item of phsFormQuestionOptionFlagEnumList" >{{item.name}}</ng-option>
                                    </ng-select>
                                </div>
                            </div>
                            <div class="col-md-12">
                                <button   class="btn btn-dynamic-2c btn-sm mx-0 mt-3 mb-0 " (click)="saveQuestionOption(item)">Edit Option</button>
                            </div>
                        </div>
                    </div>
                    <div *ngIf="showAddAnswerTab" class="border-question">
                        <div (click)="showAddAnswerTab=false" class="cross-option ">
                            <span class="fa fa-times-circle-o fa-lg text-grey"></span>
                        </div>
                        <div class="row">
                            <div class="col-md-7">
                                <div class="form-group mb-0">
                                    <label for="searchBy" class="">Answer Option</label>
                                    <input type="text"  autocomplete="off" [(ngModel)]="addEditPHSFormQuestionOptionDto.text" class="form-control form-control-sm box-shadow w-100"
                                     id="searchBy" placeholder="Answer Option" value="No" />
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="form-group mb-0">
                                    <label for="searchBy" class="">Weight</label>
                                    <input type="number"  [(ngModel)]="addEditPHSFormQuestionOptionDto.weight" autocomplete="off" class="form-control form-control-sm box-shadow w-100"
                                     id="searchBy" placeholder="Weight" />
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group mb-0">
                                    <label for="searchBy" class="">Flag</label>
                                    <ng-select class="ng-select-small"  [(ngModel)]="addEditPHSFormQuestionOptionDto.flag" [multiple]="false"
                                        placeholder="Answer Type" [searchable]="false" [clearable]="false">
                                          <ng-option [value]="item.value" *ngFor="let item of phsFormQuestionOptionFlagEnumList" >{{item.name}}</ng-option>
                                    </ng-select>
                                </div>
                            </div>
                            <div class="col-12">
                                <button  [disabled]="!addEditPHSFormQuestionOptionDto.weight || !addEditPHSFormQuestionOptionDto.text ||  addEditPHSFormQuestionOptionDto.flag == null"  class="btn btn-dynamic-2c btn-sm mx-0 mt-3 mb-0" (click)="saveQuestionOption('')">Save Option</button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- <div class="col-md-12" *ngIf="addEditPHSFormQuestionOptionDto.phsFormQuestionId && addEditPHSFormQuestionOptionDto.questionType == 1 && showAddAnswerTab" >
                    <div *ngFor="let item of phsQuestionOptionsList" class="border-question">
                        <div class="cross-option ">
                            <span class="fa fa-times-circle-o fa-lg text-grey"></span>
                        </div>
                        <div class="row">
                            <div class="col-md-7">
                                <div class="form-group mb-0 ">
                                    <label for="searchBy" class="">Answer Option</label>
                                    <input type="text" [(ngModel)]="item.text"  autocomplete="off" class="form-control form-control-sm box-shadow w-100"
                                     id="searchBy" placeholder="Answer Option" />
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="form-group mb-0">
                                    <label for="searchBy" class="">Weight</label>
                                    <input type="number" [(ngModel)]="item.weight" autocomplete="off" class="form-control form-control-sm box-shadow w-100"
                                     id="searchBy" placeholder="Weight" />
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group mb-0">
                                    <label for="searchBy" class="">Flag</label>
                                    <ng-select class="ng-select-small" [(ngModel)]="item.phsFormQuestionOptionFlag"  [multiple]="false"
                                        placeholder="Answer Type">
                                        <ng-option [value]="item.value" *ngFor="let item of phsFormQuestionOptionFlagEnumList" >{{item.name}}</ng-option>
                                    </ng-select>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div  *ngIf="addEditPHSFormQuestionOptionDto.phsFormQuestionId && addEditPHSFormQuestionOptionDto.questionType == 0 && showAddAnswerTab" class="border-question mt-3">
                        <div class="cross-option ">
                            <span class="fa fa-times-circle-o fa-lg text-grey"></span>
                        </div>
                        <div class="row">
                            <div class="col-md-7">
                                <div class="form-group mb-0">
                                    <label for="searchBy" class="">Answer Option</label>
                                    <input type="text"  autocomplete="off" class="form-control form-control-sm box-shadow w-100"
                                     id="searchBy" placeholder="Answer Option" />
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="form-group mb-0">
                                    <label for="searchBy" class="">Weight</label>
                                    <input type="text"  autocomplete="off" class="form-control form-control-sm box-shadow w-100"
                                     id="searchBy" placeholder="Weight" />
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group mb-0">
                                    <label for="searchBy" class="">Flag</label>
                                    <ng-select class="ng-select-small" [multiple]="false"
                                        placeholder="Answer Type">
                                          <ng-option [value]="item.value" *ngFor="let item of phsFormQuestionOptionFlagEnumList" >{{item.name}}</ng-option>
                                    </ng-select>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div>
                        <button class="addoption">
                            <span class="fa fa-plus mr-1"></span> Add Option
                        </button>
                    </div>
                </div>
                <div class="col-md-12"*ngIf="addEditPHSFormQuestionOptionDto.phsFormQuestionId && addEditPHSFormQuestionOptionDto.questionType == 2 && showAddAnswerTab">
                    <div *ngFor="let item of phsQuestionOptionsList" class="border-question">
                        <div class="cross-option ">
                            <span class="fa fa-times-circle-o fa-lg text-grey"></span>
                        </div>
                        <div class="row">
                            <div class="col-md-7">
                                <div class="form-group mb-0 ">
                                    <label for="searchBy" class="">Answer Option</label>
                                    <input type="text" [(ngModel)]="item.text" autocomplete="off" class="form-control form-control-sm box-shadow w-100"
                                     id="searchBy" placeholder="Answer Option" />
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="form-group mb-0">
                                    <label for="searchBy" class="">Weight</label>
                                    <input type="number" [(ngModel)]="item.weight"  autocomplete="off" class="form-control form-control-sm box-shadow w-100"
                                     id="searchBy" placeholder="Weight" />
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group mb-0">
                                    <label for="searchBy" class="">Flag</label>
                                    <ng-select class="ng-select-small" [(ngModel)]="item.phsFormQuestionOptionFlag"  [multiple]="false"
                                        placeholder="Answer Type">
                                        <ng-option [value]="item.value" *ngFor="let item of phsFormQuestionOptionFlagEnumList" >{{item.name}}</ng-option>
                                    </ng-select>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="border-question mt-3">
                        <div class="cross-option ">
                            <span class="fa fa-times-circle-o fa-lg text-grey"></span>
                        </div>
                        <div class="row">
                            <div class="col-md-7">
                                <div class="form-group mb-0">
                                    <label for="searchBy" class="">Answer Option</label>
                                    <input type="text"  autocomplete="off" class="form-control form-control-sm box-shadow w-100"
                                     id="searchBy" placeholder="Answer Option" />
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="form-group mb-0">
                                    <label for="searchBy" class="">Weight</label>
                                    <input type="text"  autocomplete="off" class="form-control form-control-sm box-shadow w-100"
                                     id="searchBy" placeholder="Weight" />
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group mb-0">
                                    <label for="searchBy" class="">Flag</label>
                                    <ng-select class="ng-select-small" [(ngModel)]="item.phsFormQuestionOptionFlag"  [multiple]="false"
                                        placeholder="Answer Type">
                                        <ng-option [value]="item.value" *ngFor="let item of phsFormQuestionOptionFlagEnumList" >{{item.name}}</ng-option>
                                    </ng-select>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div>
                        <button class="addoption">
                            <span class="fa fa-plus mr-1"></span> Add Option
                        </button>
                    </div>
                </div> -->
            </div>
        </div>
    </div>
</div>
<div class="w-100 d-flex justify-content-between align-items-center"> 
    <button [disabled]="!addEditPHSFormDto.id" class="btn btn-dynamic-2c btn-sm mx-0" (click)="resetValues();showAddQuestionTab=true"><i class="fa fa-plus mr-1" ></i>Add new question</button>
    <div>
        <button [disabled]="!addEditPHSFormDto.title || !addEditPHSFormDto.chronicConditionIds.length || !addEditPHSFormDto.phsCareEpisodeIds.length" class="btn btn-dynamic-2c btn-sm " (click)="addEditPHSFormDto.status= phsFormStatusEnum['In Process'];addEditPHSForm()">Save</button>
        <button [disabled]="!addEditPHSFormDto.title || !addEditPHSFormDto.chronicConditionIds.length || !addEditPHSFormDto.phsCareEpisodeIds.length"  class="btn btn-dynamic-2c btn-sm mx-0" (click)="addEditPHSFormDto.status= phsFormStatusEnum.Published;addEditPHSForm()">Save & Publish</button>
    </div>
</div>