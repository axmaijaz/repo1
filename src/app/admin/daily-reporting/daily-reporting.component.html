<div class="d-flex align-items-center justify-content-between mb-3">

  <div class="d-flex align-items-center justify-content-start">
    <h4 class="mr-3 mb-0"><a class="text-dark" (click)="navigateBack()">
      <i class="fa fa-arrow-left"></i></a></h4>
    <h1 class="page-title mb-0">Daily Reporting</h1>
  </div>

  
  <div class="d-flex align-items-center">
    <label *ngIf="showDropDown"class="mr-3" for="practiceName">Select Care Provider</label>
    <div *ngIf="showDropDown" class="form-group mb-0">
      <ng-select class="ng-select-small" [(ngModel)]="careProviderId" style="width: 200px;"
        [ngModelOptions]="{standalone: true}" [closeOnSelect]="true" [multiple]="false" [searchable]="true"
        placeholder="Select Care Provider" (ngModelChange)="getAllReportsBycareproviderId()">
        <ng-option [value]="0">All</ng-option>
        <ng-option *ngFor="let item of CareProvidersList" [value]="item.id">{{item.lastName}},{{item.firstName}}
        </ng-option>
      </ng-select>
    </div>
    <button type="button" class="btn btn-dynamic-2c btn-sm mr-0" (click)="setDate();reportId = 0;addDailyReport.show()"
      title="Add Daily Report" placement="left">Add
      New</button>
  </div>
</div>


<div class="table-data-list">
  <div *ngIf="isLoading" class="d-flex justify-content-center text-center">
    <mdb-progress-bar class="progress primary-color-dark mb-0" mode="indeterminate"></mdb-progress-bar>
  </div>
  <ngx-datatable class="material" [columnMode]="'force'" [headerHeight]="50" [footerHeight]="50" [rowHeight]="35"
    [scrollbarV]="false" [scrollbarH]="false" [rows]="dailyReportingList" [limit]="10">
    <ngx-datatable-column name="CP Name" width="200">
      <ng-template ngx-datatable-cell-template let-value="value" let-row="row" let-rowIndex="rowIndex">
        <div class="d-flex justify-content-between align-items-center">
          <a class="mb-0 text-left" style="width:150px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;display: block;">{{row.careProviderName}}</a>
          <button type="button" class="btn btn-icon btn-dynamic-2c ml-2"
            (click)="getDailyReportByReportId(row);addDailyReport.show()">
            <span class="fa fa-pencil fa-lg"></span></button>
        </div>
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="Date" prop="date">
      <ng-template let-row="row" ngx-datatable-cell-template>
        {{row.date | dateFormatPipe}}
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="Potential" prop="potentialPatients">
    </ngx-datatable-column>
    <ngx-datatable-column name="Enrolled" prop="patientsenrolled">
    </ngx-datatable-column>
    <ngx-datatable-column name="Contacted" prop="patientContacted">
    </ngx-datatable-column>
    <ngx-datatable-column name="Completed" prop="patientCompleted">
    </ngx-datatable-column>
    <ngx-datatable-column name="Note" prop="dailyNote">
    </ngx-datatable-column>
  </ngx-datatable>
</div>


<div mdbModal #addDailyReport="mdbModal" class="modal fade bottom" tabindex="-1" role="dialog"
  aria-labelledby="myaddDepartmentLabel" aria-hidden="true" [config]="{backdrop: true, ignoreBackdropClick: true}">
  <div class="modal-dialog modal-md modal-dialog-scrollable" role="document">

    <div class="modal-content" [formGroup]="dailyReportinForm">
      <div class="modal-header">
        <button type="button" class="close pull-right" aria-label="Close" (click)="addDailyReport.hide() ">
          <span aria-hidden="true">×</span>
        </button>
        <h4 class="modal-title w-100" *ngIf="reportId === 0" id="myModalLabel">Add Daily Report</h4>
        <h4 class="modal-title w-100" *ngIf="reportId > 0" id="myModalLabel">Edit Daily Report</h4>
      </div>

      <div class="modal-body">
        <div class="row">
          <div class="col-sm-12">
            <div class="input-group form-group" [ngClass]="{disabledDiv: reportId}">
              <label class="w-100">Date<small class="text-danger">*</small></label>
              <input type="text" class="form-control form-control-sm" #dateToDp="dpDayPicker"
                [dpDayPicker]="datePickerConfig" formControlName="date" [readOnly]="reportId" [ngClass]="{ 'is-invalid':(dailyReportinForm.get('date').touched || dailyReportinForm.get('date').dirty) &&
                  !dailyReportinForm.get('date').valid }" [theme]="'dp-material ccm-date-picker'" [mode]="'day'" />
              <span class="invalid-feedback">
                <span *ngIf="!!dailyReportinForm.get('date').errors && (dailyReportinForm.get('date').touched ||
                          dailyReportinForm.get('date').dirty)">
                  Please enter diagnosis date.
                </span>
              </span>
            </div>
          </div>
        </div>

        <div class="master-care-plan">

          <h3 class="section-title p-0">Enrollment</h3>
          <section>
            <div class="row">
              <div class="col-sm-6">
                <div class="form-group">
                  <label for="potentialPatients">Potential Patients</label>
                  <input type="number" class="form-control form-control-sm" min="0"
                    oninput="validity.valid||(value='dailyReportinForm.get(potentialPatients).value');"
                    formControlName="potentialPatients" id="potentialPatients" placeholder="">
                </div>
              </div>

              <div class="col-sm-6">
                <div class="form-group">
                  <label for="patientsEnrolled">Patients Enrolled</label>
                  <input type="number" class="form-control form-control-sm" min="0"
                    oninput="validity.valid||(value='');" formControlName="patientsenrolled" id="patientsEnrolled"
                    placeholder="">
                </div>
              </div>

              <div class="col-sm-6">
                <div class="form-group">
                  <label for="denied">Denied</label>
                  <input type="number" class="form-control form-control-sm" min="0"
                    oninput="validity.valid||(value='');" formControlName="denied" id="denied" placeholder="">
                </div>
              </div>

              <div class="col-sm-6">
                <div class="form-group">
                  <label for="pendingDecision">Pending Decision</label>
                  <input type="number" class="form-control form-control-sm" min="0"
                    oninput="validity.valid||(value='');" id="pendingDecision" formControlName="pendingDecision"
                    placeholder="">
                </div>
              </div>

              <div class="col-sm-12">
                <div class="form-group">
                  <label for="noShows">No Shows</label>
                  <input type="number" class="form-control form-control-sm" min="0"
                    oninput="validity.valid||(value='');" formControlName="noShows" id="noShows" placeholder="">
                </div>
              </div>

            </div>

          </section>
          <div class="app-master-care-plan">
            <h3 class="section-title p-0">Follow up</h3>
            <section>
              <div class="row">

                <div class="col-sm-6">
                  <div class="form-group">
                    <label for="PatientContacted">Patient Contacted</label>
                    <input type="number" class="form-control form-control-sm" min="0"
                      oninput="validity.valid||(value='');" formControlName="patientContacted" id="PatientContacted"
                      placeholder="">
                  </div>
                </div>

                <div class="col-sm-6">
                  <div class="form-group">
                    <label for="patientNotAvailable">Patient Not Available</label>
                    <input type="number" class="form-control form-control-sm" min="0"
                      oninput="validity.valid||(value='');" formControlName="patientNotavailable"
                      id="patientNotAvailable" placeholder="">
                  </div>
                </div>

                <div class="col-sm-6">
                  <div class="form-group">
                    <label for="patientCompleted">Patient Completed</label>
                    <input type="number" class="form-control form-control-sm" min="0"
                      oninput="validity.valid||(value='');" formControlName="patientCompleted" id="patientCompleted"
                      placeholder="">
                  </div>
                </div>
                <div class="col-sm-6">
                  <div class="form-group">
                    <label for="patientIncompleted">Patient Incompleted</label>
                    <input type="number" class="form-control form-control-sm" min="0"
                      oninput="validity.valid||(value='');" formControlName="patientIncomplete" id="patientIncompleted"
                      placeholder="">
                  </div>
                </div>
              </div>
            </section>
          </div>
          <div class="row">
            <div class="col-lg-12 col-sm-6">
              <div class="form-group">
                <label for="dailyNote">Daily Note</label>
                <!-- <input type="text" class="form-control form-control-sm" formControlName="dailyNote" id="dailyNote"
                  placeholder=""> -->
                <textarea type="text" formControlName="dailyNote" id="dailyNote" rows="15" style="height: 100px;"
                  placeholder="Daily Note." class="form-control"></textarea>
              </div>
            </div>
          </div>

        </div>

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-dark btn-sm" aria-label="Close"
          (click)="addDailyReport.hide()">Close</button>
        <button type="button" class="btn btn-dynamic-2c btn-sm" [disabled]="!dailyReportinForm.get('date').valid"
          (click)="addEditDailyReport();addDailyReport.hide()">Save</button>
      </div>

    </div>
  </div>
</div>
<div mdbModal #ViewDailyReport="mdbModal" class="modal fade bottom" tabindex="-1" role="dialog"
  aria-labelledby="addDepartmentLabel" aria-hidden="true" [config]="{backdrop: true, ignoreBackdropClick: true}">
  <div class="modal-dialog modal-lg modal-dialog-scrollable" role="document">

    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close pull-right" aria-label="Close" (click)="ViewDailyReport.hide() ">
          <span aria-hidden="true">×</span>
        </button>
        <h4 class="modal-title w-100" id="myModalLabel">Daily Reporting</h4>
      </div>

      <div class="modal-body">

        <div class="row daily-reporting">
          <div class="col-lg-6 col-md-6 col-sm-12">
            <div class="panel z-depth-0">
              <div class="panel-header px-0">
                <h3>Enrollment</h3>
              </div>
              <div class="panel-body p-0">
                <div class="row">
                  <div class="col-lg-6 col-md-6">
                    <p class="alert alert-secondary">Potential Patient: <strong>3</strong></p>
                  </div>
                  <div class="col-lg-6 col-md-6">
                    <p class="alert alert-warning">Pending Decision: <strong>3</strong></p>
                  </div>
                  <div class="col-lg-6 col-md-6">
                    <p class="alert alert-secondary">Potential Enrolled: <strong>3</strong></p>
                  </div>
                  <div class="col-lg-6 col-md-6">
                    <p class="alert alert-danger">No Show: <strong>3</strong></p>
                  </div>
                  <div class="col-lg-6 col-md-6">
                    <p class="alert alert-danger">Denied: <strong>3</strong></p>
                  </div>
                </div>
              </div>
            </div>

          </div>
          <div class="col-lg-6 col-md-6 col-sm-12">
            <div class="panel z-depth-0">
              <div class="panel-header px-0">
                <h3>Follow Up</h3>
              </div>
              <div class="panel-body p-0">
                <div class="row">
                  <div class="col-md-6">
                    <p class="alert alert-secondary">Potential Contacted: <strong>3</strong></p>
                  </div>
                  <div class="col-md-6">
                    <p class="alert alert-secondary">Potential Contacted: <strong>3</strong></p>
                  </div>
                  <div class="col-md-6">
                    <p class="alert alert-danger">Patient Not Available: <strong>3</strong></p>
                  </div>
                  <div class="col-md-6">
                    <p class="alert alert-danger">Patient Incompleted: <strong>3</strong></p>
                  </div>
                </div>
              </div>
            </div>

          </div>
        </div>
        <div class="row">
          <div class="col-sm-12">
            <table class="table table-striped btn-table">
              <thead class="bg-dynamic-2c text-white">
                <tr>
                  <th>Patient Name</th>
                  <th>Status</th>
                  <th>Modified Dare</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Hassan Khan</td>
                  <td>Identified</td>
                  <td>12 Nov 2020 00:00 PM</td>
                </tr>
                <tr>
                  <td>Hassan Khan</td>
                  <td>Identified</td>
                  <td>12 Nov 2020 00:00 PM</td>
                </tr>
                <tr>
                  <td>Hassan Khan</td>
                  <td>Identified</td>
                  <td>12 Nov 2020 00:00 PM</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-dark btn-sm" aria-label="Close"
          (click)="ViewDailyReport.hide()">Close</button>
        <!-- <button type="button" class="btn btn-dynamic-2c btn-sm" [disabled]="!dailyReportinForm.get('date').valid"
            (click)="addEditDailyReport();ViewDailyReport.hide()">Save</button> -->
      </div>

    </div>
  </div>
</div>
